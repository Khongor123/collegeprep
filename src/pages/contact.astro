---
import BaseLayout from '../layouts/BaseLayout.astro';
import Button from '../components/Button.astro';
---

<BaseLayout
    title="Contact"
    description="Get in touch through our contact form! We'd love to hear from you."
    showHeader={false}
>
    <div class="max-w-2xl mx-auto">
        <h1 class="text-3xl leading-tight font-serif font-medium sm:text-5xl sm:leading-tight mb-8">Get in touch</h1>

        <p class="text-lg mb-16">Use the form below to get in touch with us. We'll get back to you as soon as possible!</p>

        <form
            id="contact-form"
            class="space-y-8"
            action="https://formspree.io/f/xanjvqpd"
            method="POST"
        >
            <div class="space-y-3">
                <label for="name" class="block text-base font-medium text-main">Name *</label>
                <input
                    type="text"
                    id="name"
                    name="name"
                    required
                    class="contact-input block w-full px-6 py-4 border-2 border-gray-300 rounded-lg leading-6 bg-transparent placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                    placeholder="Your name"
                />
            </div>

            <div class="space-y-3">
                <label for="email" class="block text-base font-medium text-main">Email *</label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    required
                    pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
                    class="contact-input block w-full px-6 py-4 border-2 border-gray-300 rounded-lg leading-6 bg-transparent placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"
                    placeholder="your.email@example.com"
                />
            </div>

            <div class="space-y-3">
                <label for="message" class="block text-base font-medium text-main">Message *</label>
                <textarea
                    id="message"
                    name="message"
                    required
                    rows="8"
                    class="contact-input block w-full px-6 py-4 border-2 border-gray-300 rounded-lg leading-6 bg-transparent placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-none"
                    placeholder="Your message..."
                ></textarea>
            </div>

            <div class="pt-6">
                <Button type="submit" class="px-12 py-4 text-base font-medium">
                    Send Message
                </Button>
                <div id="form-status" class="mt-6 text-sm"></div>
            </div>
        </form>
    </div>
</BaseLayout>

<style>
    /* Override any Formspree default styles */
    .contact-input {
        font-size: 16px !important;
        line-height: 1.5 !important;
        color: inherit !important;
        background-color: transparent !important;
        border: 2px solid #d1d5db !important;
        border-radius: 8px !important;
        padding: 16px 24px !important;
        width: 100% !important;
        box-sizing: border-box !important;
        transition: all 0.2s ease !important;
    }

    .contact-input:focus {
        outline: none !important;
        border-color: #3b82f6 !important;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2) !important;
    }

    .contact-input::placeholder {
        color: #6b7280 !important;
        opacity: 1 !important;
    }

    /* Ensure labels are properly styled */
    label {
        font-weight: 500 !important;
        color: inherit !important;
        margin-bottom: 8px !important;
        display: block !important;
    }

    /* Button styling */
    button[type="submit"] {
        background-color: #3b82f6 !important;
        color: white !important;
        border: none !important;
        border-radius: 8px !important;
        padding: 16px 48px !important;
        font-size: 16px !important;
        font-weight: 500 !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
    }

    button[type="submit"]:hover {
        background-color: #2563eb !important;
        transform: translateY(-1px) !important;
    }

    button[type="submit"]:disabled {
        opacity: 0.6 !important;
        cursor: not-allowed !important;
        transform: none !important;
    }
</style>

<script is:inline>
    (function() {
        function initContactForm() {
            const form = document.getElementById('contact-form');
            const status = document.getElementById('form-status');
            const emailInput = document.getElementById('email');

            if (!form || !status || !emailInput) return;

            // Email validation
            emailInput.addEventListener('input', function() {
                const email = this.value;
                const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

                if (email && !emailPattern.test(email)) {
                    this.setCustomValidity('Please enter a valid email address');
                    this.classList.add('border-red-500');
                } else {
                    this.setCustomValidity('');
                    this.classList.remove('border-red-500');
                }
            });

            // Form submission
            form.addEventListener('submit', function(e) {
                e.preventDefault();

                const formData = new FormData(form);
                const submitButton = form.querySelector('button[type="submit"]');
                const originalText = submitButton.textContent;

                // Show loading state
                submitButton.textContent = 'Sending...';
                submitButton.disabled = true;
                status.textContent = '';
                status.className = 'mt-6 text-sm';

                fetch(form.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(response => {
                    if (response.ok) {
                        status.textContent = 'Message sent successfully! We\'ll get back to you soon.';
                        status.className = 'mt-6 text-sm text-green-600';
                        form.reset();
                    } else {
                        throw new Error('Something went wrong');
                    }
                })
                .catch(error => {
                    status.textContent = 'Sorry, there was an error sending your message. Please try again or email us directly.';
                    status.className = 'mt-6 text-sm text-red-600';
                })
                .finally(() => {
                    submitButton.textContent = originalText;
                    submitButton.disabled = false;
                });
            });
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initContactForm);
        } else {
            initContactForm();
        }
    })();
</script>